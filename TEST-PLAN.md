# خطة الاختبار الشاملة - نظام إدارة القروض
# Comprehensive Test Plan - Loan Management System

## 1. إعداد البيئة التجريبية | Test Environment Setup

### قاعدة البيانات | Database Setup
```bash
npm run setup    # إعداد قاعدة البيانات مع البيانات التجريبية
npm run reset    # إعادة تعيين قاعدة البيانات
npm run dev      # تشغيل الخادم في وضع التطوير
```

### بيانات الدخول التجريبية | Test Login Credentials

| نوع المستخدم | المعرف | كلمة المرور | الوصف |
|-------------|--------|------------|-------|
| المدير | 1 | admin123 | مدير النظام |
| موظف عادي | 100 | user123 | موظف برصيد جيد ورسوم موافق عليها |
| موظف برصيد أدنى | 101 | user123 | موظف برصيد 500 د.ك |
| طالب | 102 | user123 | طالب برصيد 1500 د.ك |
| موظف رسوم معلقة | 103 | user123 | موظف برسوم انضمام معلقة |
| موظف جديد | 104 | user123 | موظف مسجل حديثاً (أقل من سنتين) |
| موظف برصيد عالي | 105 | user123 | موظف برصيد 5000 د.ك |

## 2. اختبارات الأمان | Security Tests

### 2.1 اختبار المصادقة | Authentication Tests
- [ ] تسجيل دخول المدير بالمعرف والرقم السري الصحيح
- [ ] تسجيل دخول المستخدم العادي
- [ ] رفض تسجيل الدخول بمعلومات خاطئة
- [ ] انتهاء صلاحية رمز JWT بعد المدة المحددة
- [ ] إعادة توجيه المستخدم غير المسجل إلى صفحة تسجيل الدخول

### 2.2 اختبار الصلاحيات | Authorization Tests
- [ ] منع المستخدم العادي من الوصول للوحة الإدارية
- [ ] منع المستخدم من تعديل بيانات مستخدمين آخرين
- [ ] تحقق من صحة JWT token في كل طلب API

## 3. اختبارات واجهة المستخدم | User Interface Tests

### 3.1 تسجيل الدخول والتنقل | Login & Navigation
- [ ] عرض صفحة تسجيل الدخول بالعربية
- [ ] التنقل بين التبويبات (تسجيل دخول، تسجيل جديد، الشروط والأحكام)
- [ ] عرض لوحة المستخدم بعد تسجيل الدخول الناجح
- [ ] تسجيل الخروج وإعادة التوجيه

### 3.2 لوحة المستخدم | User Dashboard
- [ ] عرض الرصيد الحالي بشكل صحيح
- [ ] عرض حالة القرض النشط (إن وجد)
- [ ] عرض تاريخ المعاملات في تبويب منفصل
- [ ] عرض تاريخ أقساط القروض في تبويب منفصل

### 3.3 حاسبة القروض | Loan Calculator
- [ ] حساب القسط الشهري بناءً على المبلغ والرصيد
- [ ] تطبيق الحد الأدنى 20 د.ك للقسط الشهري
- [ ] عرض الحد الأقصى للقرض (الرصيد × 3، بحد أقصى 10000 د.ك)
- [ ] التحقق من صحة المدخلات

## 4. اختبارات منطق الأعمال | Business Logic Tests

### 4.1 أهلية القروض | Loan Eligibility
- [ ] **المستخدم 100**: مؤهل للقرض (رصيد جيد، رسوم موافق عليها، مسجل أكثر من سنتين)
- [ ] **المستخدم 101**: مؤهل للقرض (رصيد أدنى 500 د.ك)
- [ ] **المستخدم 102**: مؤهل للقرض (طالب برصيد كافي)
- [ ] **المستخدم 103**: غير مؤهل (رسوم انضمام معلقة)
- [ ] **المستخدم 104**: غير مؤهل (مسجل أقل من سنتين)

### 4.2 حسابات القروض | Loan Calculations
- [ ] **2000 د.ك برصيد 1000 د.ك**: قسط = 30 د.ك شهرياً
- [ ] **1000 د.ك برصيد 500 د.ك**: قسط = 20 د.ك شهرياً (الحد الأدنى)
- [ ] **3000 د.ك برصيد 2000 د.ك**: قسط = 30 د.ك شهرياً
- [ ] **1500 د.ك برصيد 1000 د.ك**: قسط = 20 د.ك شهرياً

### 4.3 قيود القروض | Loan Restrictions
- [ ] عدم السماح بطلب قرض جديد مع وجود قرض نشط
- [ ] التحقق من دفع الاشتراكات (240 د.ك للموظفين، 120 د.ك للطلاب)
- [ ] التحقق من فترة الانتظار 11 شهراً بين القروض
- [ ] التحقق من الحد الأدنى للرصيد (500 د.ك)

## 5. اختبارات قاعدة البيانات | Database Tests

### 5.1 العمليات الأساسية | Basic Operations
- [ ] إدراج مستخدم جديد
- [ ] تحديث بيانات المستخدم
- [ ] إدراج معاملة جديدة
- [ ] تحديث حالة المعاملة

### 5.2 تكامل البيانات | Data Integrity
- [ ] القيود الخارجية (Foreign Key Constraints)
- [ ] فريدية البريد الإلكتروني
- [ ] صحة أنواع البيانات والقيم الافتراضية

### 5.3 الاستعلامات المعقدة | Complex Queries
- [ ] حساب إجمالي الودائع للمستخدم
- [ ] حساب إجمالي أقساط القروض المدفوعة
- [ ] تتبع حالة القروض النشطة

## 6. اختبارات الوحة الإدارية | Admin Panel Tests

### 6.1 إدارة المستخدمين | User Management
- [ ] عرض قائمة جميع المستخدمين
- [ ] عرض تفاصيل المستخدم (الرصيد، المعاملات، القروض)
- [ ] الموافقة على رسوم الانضمام
- [ ] رفض رسوم الانضمام

### 6.2 إدارة القروض | Loan Management
- [ ] عرض جميع طلبات القروض
- [ ] الموافقة على طلب قرض
- [ ] رفض طلب قرض مع ملاحظات
- [ ] تتبع حالة أقساط القروض

### 6.3 إدارة المعاملات | Transaction Management
- [ ] عرض جميع المعاملات
- [ ] الموافقة على طلبات الإيداع
- [ ] رفض معاملات مشبوهة

## 7. اختبارات التقارير | Reports Tests

### 7.1 التقارير الأساسية | Basic Reports
- [ ] تقرير الأعضاء (قائمة المستخدمين مع الأرصدة)
- [ ] تقرير القروض (جميع طلبات القروض وحالاتها)
- [ ] تقرير المعاملات (جميع المعاملات المالية)

### 7.2 التقارير التحليلية | Analytical Reports
- [ ] التقرير المالي الشامل (حالة النظام المالية)
- [ ] التقرير الشهري (أنشطة الشهر الحالي)
- [ ] تقرير القروض النشطة (تقدم سداد القروض)

### 7.3 تصدير التقارير | Report Export
- [ ] تصدير التقارير بصيغة HTML
- [ ] طباعة التقارير
- [ ] تنسيق التقارير للطباعة

## 8. اختبارات الأداء | Performance Tests

### 8.1 أوقات الاستجابة | Response Times
- [ ] تسجيل الدخول < 2 ثانية
- [ ] تحميل لوحة المستخدم < 3 ثواني
- [ ] حساب القرض < 1 ثانية
- [ ] عرض التقارير < 5 ثواني

### 8.2 الحمولة | Load Testing
- [ ] 10 مستخدمين متزامنين
- [ ] 50 مستخدم متزامن
- [ ] استهلاك الذاكرة تحت الحمولة

## 9. اختبارات التوافق | Compatibility Tests

### 9.1 المتصفحات | Browser Compatibility
- [ ] Chrome (أحدث إصدار)
- [ ] Firefox (أحدث إصدار)
- [ ] Safari (أحدث إصدار)
- [ ] Edge (أحدث إصدار)

### 9.2 الأجهزة المحمولة | Mobile Compatibility
- [ ] عرض متجاوب على الهاتف
- [ ] عرض متجاوب على التابلت
- [ ] دعم اللمس

## 10. اختبارات إعادة تعيين كلمة المرور | Password Reset Tests

### 10.1 التحقق من الهوية | Identity Verification
- [ ] التحقق من البريد الإلكتروني ورقم الهاتف
- [ ] رفض المعلومات غير المطابقة
- [ ] عرض رسائل خطأ واضحة

### 10.2 تحديث كلمة المرور | Password Update
- [ ] تطبيق الحد الأدنى 6 أحرف
- [ ] تشفير كلمة المرور الجديدة
- [ ] تسجيل العملية في تاريخ المعاملات

## 11. اختبارات نظام الوصايا | Will System Tests

### 11.1 كتابة الوصية | Will Creation
- [ ] حفظ محتوى الوصية
- [ ] تحديث الوصية الموجودة
- [ ] التحقق من صحة النص

### 11.2 عرض الوصايا للإدارة | Admin Will Viewing
- [ ] عرض وصايا المستخدمين في لوحة الإدارة
- [ ] أمان عرض الوصايا للمدير فقط

## 12. سيناريوهات الاختبار الشاملة | End-to-End Test Scenarios

### سيناريو 1: دورة حياة القرض الكاملة
1. تسجيل دخول المستخدم (100)
2. التحقق من الأهلية للقرض
3. طلب قرض بمبلغ 2000 د.ك
4. تسجيل دخول المدير والموافقة على القرض
5. دفع قسط شهري
6. متابعة حالة القرض

### سيناريو 2: رفض القرض
1. تسجيل دخول المستخدم (103) - رسوم معلقة
2. محاولة طلب قرض
3. عرض رسالة خطأ واضحة
4. تسجيل دخول المدير والموافقة على رسوم الانضمام
5. إعادة محاولة طلب القرض

### سيناريو 3: إدارة المعاملات
1. طلب إيداع من المستخدم
2. مراجعة الطلب من المدير
3. الموافقة على الإيداع
4. تحديث رصيد المستخدم

## 13. معايير النجاح | Success Criteria

### وظيفية | Functional
- [ ] جميع الحسابات المالية صحيحة
- [ ] قواعد الأهلية تعمل بدقة
- [ ] أمان البيانات محفوظ

### تقنية | Technical
- [ ] لا توجد أخطاء في وحدة التحكم
- [ ] جميع استعلامات قاعدة البيانات تعمل
- [ ] لا توجد تسريبات في الذاكرة

### تجربة المستخدم | User Experience
- [ ] واجهة سهلة الاستخدام
- [ ] رسائل خطأ واضحة بالعربية
- [ ] أوقات استجابة مقبولة

## 14. أدوات الاختبار | Testing Tools

### اختبار يدوي | Manual Testing
- متصفح ويب لاختبار الواجهة
- أدوات مطور المتصفح للتحقق من الأخطاء
- Postman لاختبار API (اختياري)

### اختبار قاعدة البيانات | Database Testing
- MySQL Workbench أو phpMyAdmin
- فحص البيانات المباشر

### مراقبة الأداء | Performance Monitoring
- أدوات مطور المتصفح (Network, Performance)
- مراقبة استهلاك الذاكرة

## ملاحظات مهمة | Important Notes

1. **إعادة تعيين البيانات**: استخدم `npm run reset` لإعادة تعيين قاعدة البيانات قبل كل جولة اختبار رئيسية
2. **بيئة الاختبار**: تأكد من تشغيل الخادم في وضع التطوير (`npm run dev`)
3. **ملفات البيئة**: تحقق من وجود ملف `.env` مع إعدادات قاعدة البيانات الصحيحة
4. **نسخ احتياطية**: احتفظ بنسخة احتياطية من قاعدة البيانات قبل الاختبارات المدمرة

## التوثيق والتتبع | Documentation & Tracking

- سجل جميع الأخطاء المكتشفة مع خطوات إعادة الإنتاج
- التقط لقطات شاشة للأخطاء في الواجهة
- سجل أوقات الاستجابة للعمليات الرئيسية
- وثق أي انحرافات عن السلوك المتوقع